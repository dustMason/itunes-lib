// Generated by CoffeeScript 1.3.3
(function() {
  var ITunesLib, fs, ituneslib, moment, plist, _;

  _ = require('underscore');

  fs = require('fs');

  plist = require('plist');

  moment = require('moment');

  module.exports = ituneslib = function(options) {
    var itunesLib;
    if (options == null) {
      options = {};
    }
    return itunesLib = module.exports.instance = new ITunesLib(options);
  };

  ITunesLib = (function() {

    function ITunesLib(filepath) {
      this.data = plist.parseFileSync(filepath);
      this.tracks = this.data["Tracks"];
    }

    ITunesLib.prototype.size = function() {
      return Object.keys(this.tracks).length;
    };

    ITunesLib.prototype.songs = function() {
      return _.map(this.tracks, function(track) {
        return {
          title: track["Name"],
          artist: track["Artist"],
          album: track["Album"],
          play_count: track["Play Count"],
          date_added: moment(track["Date Added"]).toDate(),
          play_date: moment(track["Play Date UTC"]).toDate()
        };
      });
    };

    return ITunesLib;

  })();

}).call(this);
